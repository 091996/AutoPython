import datetime
import requests
Url = 'http://qa-plasma.gdmk.cn:8280/Regist/Archive/Create'
id = "445381199208228808"
GMT_FORMAT = '%a, %d %b %Y %H:%M:%S GMT'
Date = datetime.datetime.utcnow().strftime(GMT_FORMAT)
header = {
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
    "Accept-Encoding": "gzip, deflate",
    "Accept-Language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
    "Cache-Control": "max-age=0",
    "Connection": "keep-alive",
    "Content-Type": "application/x-www-form-urlencoded",
    "Cookie": ".ASPXAUTH=DD9FD46585FCE793BCE261375DC70002A8AE025AFFD9EE9143748D7DD62A471AF1079B5AB26F1F64DC27998C230E61792378C038863901A4BECF661E16EAE5258C773D87C36D8C3150CDA3E00C1EF5F61EE13D3F014A2963D65BC17EB61A7A7F36C586774DE475FFD3484CE2BC7ADFA7F023C7F7233D63642BE4C563AC835B0CB6DDB87A8660817A8AEE8E67146532833FCCEA8C7B43740432EA8B92A9DFCF9D8C01475D07994E07090DCEF61D82FA4CE3C88DB9063FADCF67A667BB2216ECCBC2A36BCEE62C7C9CC776F101A6B892099169271BE6CA3159322B460DDBE632B036988F40D3E1C55E38CE2C0CA508242165B14BECBCC8375B30422A636AA7349400290D0A12124EF3ECC14F46C6551684D507DCD8005CC6BB3B7668D107E5911ED24BDE4BBA12E5022D1C7D68957483638926447CC17FB2BB876D9D4BA388470A5B20979ED7E376C5F1CD3B7F1E1C03D874A28FCEB3951F4FAEBEF9FFCEDC6DACC054FA3B5E8C127271F041F2A33FC41CDCFC59A8426189CC6043C39DEB9627A6F5BB4CD4871C6D6895946F68ADFC8D4EA8319484689CF304449B026C841A3E1D25B9E67566F74E33CE5ED00A604B3707EF2F053287F02E6CE70E503C73862B0200FAA56624175E2F4F886D85BFC776608294662194B26C17C2E4E9B8F12C89264BE2A1604F58DB19674C3662EA9B93A9C8EDB74582A9D6A29A71DE7AB8B65D60CC4BDB61683E6665670C44CDE09EFD1CF7FEB59498D2D35C0ABA046129BB44071342D009A0DE628422CBF3E7D8915DA9505256A3B8435354ACA976F5A3848CEEF02F754F3F5A1400BFF99E2780D4659197AE7CC660004ED2CAD942E8B32587EA3F0D4D64C89B69C56EDF075B9B0EF7E1074D791256C2FB8CF7E8FABDA41EAAC3E4AE7EB4BA9C71F9A2E7BB1C0FFF4AF22AF827D8D7CA7CC5ACE01FD4BC29CE99C53D49EEC80B4BB47B66378479845672C90EA8B682ABAB5E4BDAE9BCAA0CDA5A9DBCF9638A772D64FE36BBA81B759CC367359E9AE1AB23E45DB5E7C4C05919C7205CBD98F8D2D6DBE3D84495F8335E05CACC9293B2EA0A218506EC163F8EA881D1335498FBB3A54B5055FF82FAA96A5240284ACAB6D8BF2FE1064D7CF4E3973C575E7B94A7BA228C085D6E87B4A8F70CF8504BFE1A6BE0542D8F0CAAB2343F66; __RequestVerificationToken=RbVIQGPN0VYmljBlhLqH9bcyUrGYPqRiZKL2ST_ErbNlUMzpffs90501_UbdyWR-GjLbfPwq4RZ1ChDVQqwChp041cMa5cxfGDgagncQWw41; ASP.NET_SessionId=hwywreqtrx4chc2oklk4kbip; RegistBiometric=1",
    "Upgrade-Insecure-Requests": "1",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36 Edg/101.0.1210.39"
}
# print(header)

body = """Score=&PersonalInfo.IDPhoto=&PersonalInfo.FacePice=&PersonalInfo.IDPhotoBase64=&PersonalInfo.IDPhoto=&PersonalInfo.PictureBase64=&Biometric=0&ArchiveCode=&DateCollected=2022-05-12&PersonalInfo.Name=%E7%BD%97%E6%A1%82%E6%96%B0&PersonalInfo.Race=%E6%B1%89%E6%97%8F&PersonalInfo.Birthday=1996-09-28&PersonalInfo.Gender=1&Age=25&PersonalInfo.IDType=%E8%BA%AB%E4%BB%BD%E8%AF%81&PersonalInfo.IDNum={}&PersonalInfo.IdBeginDate=2017-05-01&PersonalInfo.Organization=%E5%B9%BF%E4%B8%9C%E7%9C%81%E7%BD%97%E5%AE%9A%E5%B8%82&PersonalInfo.IDExpireDate=2027-05-01&PersonalInfo.Province=%E5%B9%BF%E4%B8%9C&PersonalInfo.County=%E7%BD%97%E5%AE%9A%E5%B8%82&AreaType=1&PersonalInfo.IDAddress=%E5%B9%BF%E4%B8%9C%E7%9C%81%E7%BD%97%E5%AE%9A%E5%B8%82%E5%A4%AA%E5%B9%B3%E9%95%87&PersonalInfo.Zipcode=&Job=%E5%B7%A5%E4%BA%BA&Maintainer=&Phone=&MobilePhone=&Creator=%E7%AE%A1%E7%90%86%E5%91%98&Remark=""".format(id)

r = requests.post(Url, body, headers=header, allow_redirects=False)
if r.status_code == 302:
    finger = "http://qa-plasma.gdmk.cn:8280/Regist/Archive/Finger/{}".format(id)
    fres = requests.get(finger, headers=header, allow_redirects=False)
    print(fres.text)